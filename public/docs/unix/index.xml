<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pabpereza - DevSecOps – Unix</title><link>/docs/unix/</link><description>Recent content in Unix on Pabpereza - DevSecOps</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Mon, 20 Dec 2021 00:00:00 +0000</lastBuildDate><atom:link href="/docs/unix/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Redes</title><link>/docs/unix/redes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/redes/</guid><description>
&lt;h2 id="utilidades-de-red">Utilidades de red&lt;/h2>
&lt;p>Existen varias herramientas que nos ayudan a trabajar con redes:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ping - comprueba la conexión con un hosts y si está acttivo&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ping -c &lt;span style="color:#ae81ff">4&lt;/span> google.com &lt;span style="color:#75715e"># Con el -c 4 el número de veces que se ejecuta el ping&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Traceroute - identifica la ruta que se ha recorrido para llegar a un host&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>traceroute google.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Netstat - muestra los puertos abiertos en el sistema&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>netstat -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ARP - muestran la tabla ARP del sistema que actúa como una cache.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>arp -a &lt;span style="color:#75715e"># Muestra la relación entre direcciones IP y direcciones MAC&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="configuración-de-una-red---comando-ip">Configuración de una red - Comando IP&lt;/h2>
&lt;p>Con el comando &lt;code>ip&lt;/code> podemos alterar la configuración de una interfaz de red. Para ello hay múltiples opciones de este comando que debemos conocer previamente:&lt;/p>
&lt;p>Listar las interfaces de red, información y estado:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip addr
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># O su versión corta&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ver la configuración de una interfaz de red:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip addr show ens33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># O su versión corta&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip a s ens33
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Habilitar o deshabilitar una interfaz de red:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Habilitar&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip link set ens33 up
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Deshabilitar&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip link set ens33 down
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>El estado de una interfaz de red lo podríamos ver tras el &lt;code>state&lt;/code> de la configuración de la interfaz marcado como &lt;code>UP&lt;/code> o &lt;code>DOWN&lt;/code>.:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip a s ens33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ens33: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu &lt;span style="color:#ae81ff">1500&lt;/span> qdisc mq state UP group default qlen &lt;span style="color:#ae81ff">1000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>link/ether 00:15:5d:cc:35:ff brd ff:ff:ff:ff:ff:ff
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inet 172.17.71.94/20 brd 172.17.79.255 scope global eth0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> valid_lft forever preferred_lft forever
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inet6 fe80::215:5dff:fecc:35ff/64 scope link
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> valid_lft forever preferred_lft forever
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="asignar-una-dirección-ip-a-una-interfaz-de-red">Asignar una dirección IP a una interfaz de red&lt;/h3>
&lt;p>Para asignar una dirección IP a una interfaz de red debemos usar el comando &lt;code>ip addr add&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip addr add &amp;lt;IP&amp;gt;/&amp;lt;MASCARA&amp;gt; dev &amp;lt;INTERFACE&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Por ejemplo:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip addr add 192.168.1.56/255.255.255.0 dev ens33
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#o&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip addr add 192.168.1.56/24 dev ens33
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>También podríamos añadir la dirección de broadcast:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip addr add &amp;lt;IP&amp;gt;/&amp;lt;MASCARA&amp;gt; broadcast &amp;lt;BROADCAST&amp;gt; dev &amp;lt;INTERFACE&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># O su versión corta&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip a a &amp;lt;IP&amp;gt;/&amp;lt;MASC
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="comprobando-la-puerta-de-enlace">Comprobando la puerta de enlace&lt;/h3>
&lt;p>Para comprobar si una interfaz de red tiene una puerta de enlace activa podemos usar el comando &lt;code>ip route show&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip route show
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>También podemos obtener la información de enrutamiento a una IP particular usando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ip route get &amp;lt;IP&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="configuración-de-una-red---networkmanager">Configuración de una red - NetworkManager&lt;/h2>
&lt;p>Antes de comenzar, vamos a parar el servicio &amp;rsquo;network-manager&amp;rsquo; para que no interfiera con nuestra configuración. Este servicio es el encargado de gestionar las redes.
Esto lo podemos hacer con el comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>systemctl stop network-manager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para configurar una red en Ubuntu Server tendremos que crear un fichero llamado &lt;code>01-netcfg.yaml&lt;/code> en la carpeta &lt;code>/etc/netplan&lt;/code>.
El fichero especifica por cada red si queremos utilizar DHCP, dirección IP manual (en caso de no usar DHCP), gateays y servidores DNS &lt;code>nameservers&lt;/code>.
Ejemplo (obviar las líneas que comienzan por &lt;code>#&lt;/code> ya que son comentarios para explicar el fichero):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">network&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">renderer&lt;/span>: &lt;span style="color:#ae81ff">NetworkManager&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Se especifiaca cada una de las redes que queremos configurar&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ethernets&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Ejemplo de red con DHCP que recibirá la dirección IP automáticamente&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ens33&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dhcp4&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dhcp6&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">nameservers&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">addresses&lt;/span>: [&lt;span style="color:#ae81ff">8.8.8.8&lt;/span>, &lt;span style="color:#ae81ff">8.8.4.4&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Ejemplo de una red con IP manual&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ens38&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dhcp4&lt;/span>: &lt;span style="color:#66d9ef">no&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dhcp6&lt;/span>: &lt;span style="color:#66d9ef">no&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">addresses&lt;/span>: [&lt;span style="color:#ae81ff">192.168.1.120&lt;/span>&lt;span style="color:#ae81ff">/24]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Se especifica la puerta de enlace. IP del router.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">gateway4&lt;/span>: &lt;span style="color:#ae81ff">192.168.1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">nameservers&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">addresses&lt;/span>: [&lt;span style="color:#ae81ff">8.8.8.8&lt;/span>, &lt;span style="color:#ae81ff">8.8.4.4&lt;/span>]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Una vez terminado de editar el fichero, tenemos que aplicar los cambios con el comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>netplan apply
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Finalmente, volveríamos a arrancar el servicio &amp;rsquo;network-manager&amp;rsquo; para que los cambios surjan efecto:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>systemctl start network-manager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: Grub</title><link>/docs/unix/grub/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/grub/</guid><description>
&lt;p>GNU GRUB es un cargador de arranque múltiple, desarrollado por el proyecto GNU que nos permite elegir qué Sistema Operativo arrancar de los instalados. Se usa principalmente en sistemas operativos GNU/Linux.&lt;/p>
&lt;h2 id="configurar-el-tiempo-de-espera">Configurar el tiempo de espera&lt;/h2>
&lt;p>Una configuración que siempre me gusta ajustar es el tiempo de espera, normalmente unos 5 segundos.&lt;/p>
&lt;p>Para configuraciones con múltiples sistemas operativos esta bien que haya cierto margen para elegir el que queramos pero, al menos en mi caso,
usando solo linux no veo necesidad de demorar el tiempo de arranque.&lt;/p>
&lt;p>Esta configuración se puede editar en el fichero:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">/etc/default/grub
&lt;/code>&lt;/pre>&lt;p>Cambiando el parámetro &amp;ldquo;GRUB_TIMEOUT&amp;rdquo; por el valor que deseemos:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">GRUB_DEFAULT=0
GRUB_TIMEOUT=5 # &amp;lt;-- CAMBIAR POR EL VALOR QUE QUIERAS
GRUB_DISTRIBUTOR=`lsb_release -i -s 2&amp;gt; /dev/null || echo Debian`
GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet&amp;#34;
GRUB_CMDLINE_LINUX=&amp;#34;&amp;#34;
&lt;/code>&lt;/pre>&lt;p>En mi caso, lo pongo a 0 para agilizar lo máximo posible.&lt;/p></description></item><item><title>Docs: NFS</title><link>/docs/unix/nfs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/nfs/</guid><description>
&lt;p>El servicio de NFS es un servicio de red que nos permite compartir archivos entre distintos equipos. Este funciona de forma similar a una carpeta compartida en Windows.
Esta pensado para funcionar como servidor o cliente. El servidor comparte una carpeta con uno o más clientes y los clientes acceden a los archivos de la carpeta ( montando las carpetas en su sistema de ficheros ).&lt;/p>
&lt;p>Esta guía se parte por un lado en la configuración de un servidor NFS y por otro en la configuración de un cliente NFS.&lt;/p>
&lt;h2 id="servidor">Servidor&lt;/h2>
&lt;h3 id="instalación-de-los-requisitos">Instalación de los requisitos&lt;/h3>
&lt;p>Para funcionar NFS sobre el servidor debemos instalar los siguientes paquetes:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>apt install nfs-kernel-server nfs-common
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Con esto ya podemos para a la configuración.&lt;/p>
&lt;h3 id="preparando-la-carpeta-a-compartir">Preparando la carpeta a compartir&lt;/h3>
&lt;p>Primero tenemos que crear la carpeta que vamos a compartir (en el caso de que ya la tengas puedes omitir este paso):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>mkdir &amp;lt;carpeta_compartida&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Luego tenemos que asignar un propietario especial a esta carpeta.
Este usuario &lt;code>nobody&lt;/code> y grupo &lt;code>nogroup&lt;/code> se utilizan para que los clientes remotos puedan acceder a los archivos de la carpeta compartida.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>chown nobody:nogroup &amp;lt;carpeta_compartida&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="configurando-el-servidor">Configurando el servidor&lt;/h3>
&lt;p>Para configurar el servidor NFS, debemos modificar el archivo de configuración &lt;code>/etc/exports&lt;/code>. Al final del fichero de configuración debemos añadir la siguiente línea:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>/ruta/carpeta/compartida &amp;lt;origenes permitidos&amp;gt;&lt;span style="color:#f92672">(&lt;/span>&amp;lt;opciones&amp;gt;&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ejemplo, los orígenes son todos los clientes, especificado con *.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/home/usuario/carpeta_compartida *&lt;span style="color:#f92672">(&lt;/span>rw,sync,no_subtree_check,no_root_squash&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Podíamos especificar múltiples clientes con distintas opciones por cada uno de ellos&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/ruta/carpeta/compartida 192.168.1.56&lt;span style="color:#f92672">(&lt;/span>rw,sync&lt;span style="color:#f92672">)&lt;/span> 192.168.1.68&lt;span style="color:#f92672">(&lt;/span>rw,sync&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Podemos especificar los origenes permitidos al servidor de las siguientes maneras:&lt;/p>
&lt;ul>
&lt;li>Host único: podríamos especificar una IP o un nombre de host único como origen y repetir las opciones por cada uno de ellos.&lt;/li>
&lt;li>Redes de IPs: Podríamos especificar rangos de IPs especificando la IP con máscara de red. Ejemplo, &lt;code>192.168.1.0/24&lt;/code> permitiría todas las IPs de la red desde &lt;code>192.168.1.0&lt;/code> hasta &lt;code>192.168.1.255&lt;/code>.&lt;/li>
&lt;li>Comodines: Podríamos usar &lt;code>*&lt;/code> para indicar que todos los clientes están permitidos y tambien se puede combinar con nombres de dominios. Por ejemplo, &lt;code>*.example.com&lt;/code> permitiría todos los clientes que tengan con subdominio de &lt;code>example.com&lt;/code>.&lt;/li>
&lt;li>Grupos de red: Se podría definir un grupo de equipos de red especificándolo de la siguiente manera &lt;code>@grupo_de_red&lt;/code>.&lt;/li>
&lt;/ul>
&lt;p>Veamos las diferentes opciones que podemos configurar por cada origen o grupo de orígenes:&lt;/p>
&lt;ul>
&lt;li>Permisos de lectura: &lt;code>rw&lt;/code> para lectura y escritura y &lt;code>ro&lt;/code> para solo lectura.&lt;/li>
&lt;li>Opciones de sincronización: &lt;code>sync&lt;/code> para sincronizar los archivos y &lt;code>async&lt;/code> para no sincronizar los archivos.&lt;/li>
&lt;li>Opciones de compartición: &lt;code>no_subtree_check&lt;/code> para que no se compruebe el subdirectorio y &lt;code>no_root_squash&lt;/code> para que no se comparta el root.&lt;/li>
&lt;/ul>
&lt;p>Una vez configuradas las carpetas a compartir tendríamos que reiniciar el servicio para que se aplique la nueva configuración.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>systemctl restart nfs-kernel-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="permitir-conexiones-remotas-en-el-firewall">Permitir conexiones remotas en el firewall&lt;/h3>
&lt;p>Para permitir conexiones remotas en el firewall debemos permitir conexiones al puerto &lt;code>2049&lt;/code> y &lt;code>111&lt;/code> que utiliza el servicio NFS. Con &lt;code>ufw&lt;/code> en ubuntu se puede hacer de la siguiente manera:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Permitir orígenes específicos en el firewall&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ufw allow from &amp;lt;origen&amp;gt; to any port nfs
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Permitir todos los orígenes en el firewall&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ufw allow from any to any port nfs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="cliente">Cliente&lt;/h2>
&lt;h3 id="instalación-de-los-requisitos-1">Instalación de los requisitos&lt;/h3>
&lt;p>Para funcionar NFS como cliente debemos instalar el siguiente paquete:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>apt install nfs-common
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="punto-de-montaje-o-carpeta-donde-montar-los-archivos-remotos">Punto de montaje o carpeta donde montar los archivos remotos&lt;/h3>
&lt;p>Debemos espesificar la carpeta donde vamos a montar los archivos remotos. Esto se puede hacer con el comando &lt;code>mount&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>mount &amp;lt;IP del servidor&amp;gt;:/ruta/carpeta/remota /ruta/carpeta/local
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Una vez montada la carpeta podemos listar todos los puntos de montaje del servidor con el siguiente comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>showmount -e &amp;lt;IP del servidor&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>También podríamos listar los montajes locales con el comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>df -h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Por último, podríamos desmontar un punto de montaje con el comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>umount /ruta/carpeta/local
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="montaje-automático-en-el-arranque---fstab">Montaje automático en el arranque - Fstab&lt;/h3>
&lt;p>Podemos montar automáticamente la carpeta remota en el arranque añadiendo una línea de configuración en el archivo &lt;code>/etc/fstab&lt;/code>:&lt;/p>
&lt;p>La línea tendría el siguiente formato:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&amp;lt;IP del servidor&amp;gt;:&amp;lt;ruta/carpeta/remota&amp;gt; /ruta/carpeta/local nfs &amp;lt;opciones&amp;gt; &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Por ejemplo:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>192.168.1.56:/home/user/compartida /home/cliente/compartida nfs rw,nofail,noatime,nolock,intr,tcp,actimeo&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1800&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ahora podríamos reiniciar el servidor y comprobar que la carpeta se ha montado automáticamente. A veces tarda unos segundos/minutos en realizar el montaje.&lt;/p></description></item><item><title>Docs: Zsh</title><link>/docs/unix/zsh/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/zsh/</guid><description>
&lt;p>En lo personal me encanta el terminal y en lo profesional lo veo indispensable para ciertas tareas.&lt;/p>
&lt;p>Adaptarlo a nuestras necesidades y potenciar sus utilidades de caja me parece vital si pasas muchas
horas delante de una interfaz de comandos.&lt;/p>
&lt;p>En esta guía explico como configurar zsh a mis gustos personales, (en este vídeo tenéis todo el proceso más detallado):
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/cyK89jHB9JA" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;/p>
&lt;h2 id="instalación-de-requisitos">Instalación de requisitos&lt;/h2>
&lt;p>Con el siguiente comando podéis instalar todos los requisitos necesarios para instalar zsh:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>apt install curl zsh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="instalación-de-ohmyzsh">Instalación de ohmyzsh&lt;/h2>
&lt;p>Ahora que tenemos instalado zsh podemos instalar el plugin de ohmyzsh:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sh -c &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh&lt;span style="color:#66d9ef">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>e voila!&lt;/p>
&lt;h2 id="opción-1---configuración-con-antigen-recomendada">Opción 1 - Configuración con antigen (recomendada)&lt;/h2>
&lt;p>Antigen es un plugin de ohmyzsh que nos permite configurar zsh con una interfaz más sencilla, funcionando como gestor de plugins y temas.&lt;/p>
&lt;p>Podemos descargarlo con el siguiente comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>curl -L git.io/antigen &amp;gt; antigen.zsh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Es importante que tengamos localizado el archivo &lt;code>antigen.zsh&lt;/code>, personalmente lo suelo guardar dentro de la carpeta &lt;code>.oh-my-zsh&lt;/code>
por limpieza.&lt;/p>
&lt;h2 id="configuración-de-antigen">Configuración de antigen&lt;/h2>
&lt;p>Para configurar antigen debemos añadir el siguiente comando en el fichero &lt;code>.zshrc&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">source &amp;lt;ubicación del archivo antigen.zsh&amp;gt;
&lt;/code>&lt;/pre>&lt;h2 id="instalación-de-plugin-y-temas">Instalación de plugin y temas&lt;/h2>
&lt;p>Para configurar un plugin podemos usar el comando &amp;lsquo;antigen bundle&amp;rsquo; y para seleccionar un tema se usa el comando &amp;lsquo;antigen theme&amp;rsquo;.&lt;/p>
&lt;p>Por ejemplo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Definición de plugins&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>antigen bundle git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>antigen bundle git-prompt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Definición de un tema&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>antigen theme robbyrussell
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para finalizar la configuración de antigen debemos añadir el siguiente comando en el fichero &lt;code>.zshrc&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">antigen apply
&lt;/code>&lt;/pre>&lt;p>La principal ventaja que nos aporta antigen es que deja un fichero de configuración mucho más limpio y, además, nos instala automaticamente los plugins y temas que hemos defino.&lt;/p>
&lt;p>Las próxima vez que hagamos &lt;code>source .zshrc&lt;/code> antigen se encargará de gestionarlo todo.&lt;/p>
&lt;p>&lt;em>Así quedaría el fichero &lt;code>.zshrc&lt;/code> completo:&lt;/em>&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">source ~/.oh-my-zsh/antigen.zsh
# Load the oh-my-zsh&amp;#39;s library.
antigen use oh-my-zsh
# Bundles from the default repo (robbyrussell&amp;#39;s oh-my-zsh).
antigen bundle git
antigen bundle git-prompt
antigen bundle z
antigen bundle pip
antigen bundle kubectl
antigen bundle git-prompt
antigen bundle vi-mode
antigen bundle docker
antigen bundle docker-compose
# Syntax highlighting bundle.
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle zsh-users/zsh-autosuggestions
# Load the theme.
antigen theme bureau
# Tell Antigen that you&amp;#39;re done.
antigen apply
&lt;/code>&lt;/pre>&lt;h2 id="opción-2---configuración-de-ohmyzsh-sin-antigen">Opción 2 - Configuración de ohmyzsh (Sin antigen)&lt;/h2>
&lt;p>Recuerda que todas las configuraciones que hagas en zsh se guardarán en el archivo &lt;code>.zshrc&lt;/code>. Aquí podemos editar el tema, los plugins, añadir alias.. etc.&lt;/p>
&lt;h3 id="tema">Tema&lt;/h3>
&lt;p>Se puede editar el tema de zsh en el parámentro &lt;code>ZSH_THEME&lt;/code>: del fichero &lt;code>.zshrc&lt;/code>. Por ejemplo:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">ZSH_THEME=&amp;#34;robbyrussell&amp;#34;
&lt;/code>&lt;/pre>&lt;p>Así se cambia al tema por defecto de ohmyzsh.&lt;/p>
&lt;h3 id="plugins">Plugins&lt;/h3>
&lt;p>Para añadir un plugin a zsh, debemos añadirlo en la sección &lt;code>plugins&lt;/code> del fichero &lt;code>.zshrc&lt;/code> separados por espacios. Por ejemplo:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">plugins=(git sudo docker z )
&lt;/code>&lt;/pre>&lt;h3 id="recargar-cambios">Recargar cambios&lt;/h3>
&lt;p>Recuerda que cada vez que modifiques el fichero .zshrc tendras que cargar de nuevo la configuración con el comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>source ~/.zshrc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="autocompletado-y-resaltado-de-color">Autocompletado y resaltado de color&lt;/h3>
&lt;p>Estas funcionalidades no vienen por defecto pero si podemos intalar los plugins para activarlos posteriormente. Aquí los enlaces a sus repositorios:
&lt;a href="https://github.com/zsh-users/zsh-autosuggestions">autocomplete&lt;/a>
&lt;a href="https://github.com/zsh-users/zsh-syntax-highlighting">highlight&lt;/a>&lt;/p>
&lt;p>Los podríamos instalar respectivamente con los siguientes comandos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Instalar autocompletado&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git clone https://github.com/zsh-users/zsh-autosuggestions &lt;span style="color:#e6db74">${&lt;/span>ZSH_CUSTOM&lt;span style="color:#66d9ef">:-&lt;/span>~/.oh-my-zsh/custom&lt;span style="color:#e6db74">}&lt;/span>/plugins/zsh-autosuggestions
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Instalar resaltado de color&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git clone https://github.com/zsh-users/zsh-syntax-highlighting.git &lt;span style="color:#e6db74">${&lt;/span>ZSH_CUSTOM&lt;span style="color:#66d9ef">:-&lt;/span>~/.oh-my-zsh/custom&lt;span style="color:#e6db74">}&lt;/span>/plugins/zsh-syntax-highlighting
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Los podríamos activar añadiéndolos en el parámetro de plugins en el fichero &lt;code>.zshrc&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">plugins=(zsh-syntax-highlighting zsh-autosuggestions)
&lt;/code>&lt;/pre></description></item><item><title>Docs: En navegador</title><link>/docs/unix/en_navegador/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/en_navegador/</guid><description>
&lt;p>Hoy en día cualquier aplicación la podemos ejecutar en nuestro navegador web. Pero, ¿por qué tener aplicaciones sueltas si podemos usarlo para acceder a nuestro sistema operativo completo?. Es verdad que existen soluciones como Microsoft 365, Horizon y demás, las cuales están enfocadas principalmente en entornos corporativos windows y la mayoría requieren de clientes específicos para poder usarlos.&lt;/p>
&lt;p>El objetivo de esta guía es explicar como ejecutar una distribución linux en tu navegador. Bueno, siendo sinceros, esto tiene un poco de truco. Efectivamente vamos a conseguir tener acceso a una distribución linux en el navegador, pero realmente no lo esta ejecutando el mismo.&lt;/p>
&lt;p>Normalmente este tipo de sistemas funcionan en linux gracias a un proyecto llamado Apache Guacamole. Esta es una herramienta de conexión remota que permite hacer de cliente para conectarse a un sistema a través de RDP o VNC.&lt;/p>
&lt;p>Este es el esquema de lo que vamos a hacer:&lt;/p>
&lt;p>&lt;img src="/docs/unix/guacamole_linux.drawio.svg" alt="Jerarquía de servicios">&lt;/p>
&lt;p>El objetivo es que nuestro contenedor lance un servicio de VNC o RDP que no esté expuesto y por otra parte un servidor de Apache Guacamole que exponha un servidor web al que podemos conectarnos con el navegador web. Desde esta página podremos gestionar entornos remotos y por debajo otro servicio hace de cliente contra estos entornos remotos.&lt;/p>
&lt;p>Veremos dos formas de conseguirlo, la primera totalmente automática y la segunda haremos de forma manual para desglosar los pasos.&lt;/p>
&lt;h2 id="forma-fácil-y-automática-recomendada-para-todos">Forma fácil y automática (Recomendada para todos)&lt;/h2>
&lt;p>De la mano de las imágenes de docker de &lt;a href="https://linuxserver.io">linuxserver.io&lt;/a> podemos ejecutar contenedores de linux con todo lo hablado anteriormente, en diferentes distribuciones y con diferentes gestores de ventanas.&lt;/p>
&lt;p>Ofrecen las principales distribuciones de linux, como ubuntu, alpine, fedora, arch en combinación con los gestores de ventanas más populares XFCE, KDE, i3, Openbox, IceWM&amp;hellip; etc.&lt;/p>
&lt;p>Podéis consultar el listado completo en &lt;a href="https://hub.docker.com/r/linuxserver/webtop/">linuxserver.io&lt;/a>. Este es un breve resumen del tag que tendrías que usar en la imagen de tu contenedor en función del sabor que prefieras:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Tag&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>latest&lt;/td>
&lt;td>XFCE Alpine&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ubuntu-xfce&lt;/td>
&lt;td>XFCE Ubuntu&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>fedora-xfce&lt;/td>
&lt;td>XFCE Fedora&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>arch-xfce&lt;/td>
&lt;td>XFCE Arch&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>alpine-kde&lt;/td>
&lt;td>KDE Alpine&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ubuntu-kde&lt;/td>
&lt;td>KDE Ubuntu&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>fedora-kde&lt;/td>
&lt;td>KDE Fedora&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>arch-kde&lt;/td>
&lt;td>KDE Arch&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Para ejecutar un contenedor de esta forma, simplemente ejecutamos el comando con la configuración de los diferentes parámetros. Importante entender los parámetros opciones, concretamente, el montaje del socket. Este nos permitirá usar docker dentro del contenedor pero pondrá en riesgo la seguridad de nuestro entorno en caso de ser vulnerado.&lt;/p>
&lt;p>Sobre la seguridad en contenedores hablo más extendidamente en esta video entrada &lt;a href="/docs/pentesting/privilegios/contenedores.md">Seguridad en contenedores&lt;/a>.&lt;/p>
&lt;p>Comando de ejemplo (en la sección de &lt;em>Parameters&lt;/em> de DockerHub se explica cada uno de ellos):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>docker run -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --name&lt;span style="color:#f92672">=&lt;/span>webtop &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --security-opt seccomp&lt;span style="color:#f92672">=&lt;/span>unconfined &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#optional` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -e PUID&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -e PGID&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -e TZ&lt;span style="color:#f92672">=&lt;/span>Europe/London &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -e SUBFOLDER&lt;span style="color:#f92672">=&lt;/span>/ &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#optional` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -e KEYBOARD&lt;span style="color:#f92672">=&lt;/span>en-us-qwerty &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#optional` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -p 3000:3000 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /path/to/data:/config &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /var/run/docker.sock:/var/run/docker.sock &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#optional` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --device /dev/dri:/dev/dri &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#optional` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --shm-size&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;1gb&amp;#34;&lt;/span> &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#optional` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --restart unless-stopped &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> lscr.io/linuxserver/webtop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Personalmente, si no necesitas usar docker dentro de este contenedor ni montar ningún archivo lo ejecutaría así (para potenciar su seguridad, poner el teclado en español y la hora local):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>docker run -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --name&lt;span style="color:#f92672">=&lt;/span>pabpereza.dev &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --security-opt seccomp&lt;span style="color:#f92672">=&lt;/span>unconfined &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e"># Activar solo si no te funciona correctamente` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -e PUID&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -e PGID&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -e TZ&lt;span style="color:#f92672">=&lt;/span>Europe/Madrid &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e"># Hora local` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -e KEYBOARD&lt;span style="color:#f92672">=&lt;/span>es-es-qwerty &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e"># Teclado en castellano` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -e AUTO_LOGIN&lt;span style="color:#f92672">=&lt;/span>true &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e"># Poner a false para quitar el autologin (recuerda cambiar la pass)` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -p 3000:3000 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /var/run/docker.sock:/var/run/docker.sock &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#Borrar si no queremos usar docker dentro del contenedor` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --shm-size&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;1gb&amp;#34;&lt;/span> &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e">#Previene a los navegadores modernos fallar por límites de memoria` \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --restart unless-stopped &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> lscr.io/linuxserver/webtop &lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#75715e"># Despues de webtop con : podríamos añadir el tag para usar la distribución que queramos por defecto Alpine con XFCE`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ya lo tendríamos funcionando. También podemos mejorar el rendimiento siguiendo la guía de &lt;em>Hardware acceleration&lt;/em> (en la página de &lt;a href="https://hub.docker.com/r/linuxserver/webtop/">DockerHub&lt;/a>) aunque solo funciona en el contenedor de ubuntu.&lt;/p>
&lt;p>Más que aconsejable cambiar la contraseña al usuario del contenedor para que nadie pueda acceder a él directamente o poner un proxy previo con autenticación de algún tipo. Además, puedes desactivar el &lt;code>autologin&lt;/code> (Variable de entorno AUTO_LOGIN en el comando de docker run).&lt;/p>
&lt;p>Esto lo podemos hacer con el comando (en un terminal dentro del contenedor):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo passwd &amp;lt;usuario&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Seguidamente se nos pedirá la nueva contraseña para el usuario (si os pide la anterior por defecto es &lt;em>abc&lt;/em> como el usuario). Las próximas veces que entréis al contenedor a través del navegador os pedirá la contraseña para conectarse.&lt;/p></description></item><item><title>Docs: Desactivar swap</title><link>/docs/unix/desactivar_swap/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/desactivar_swap/</guid><description>
&lt;p>Para ciertos escenarios es recomendable desactivar el swap o incluso obligatorio. Por ejemplo, en el caso de kubernetes si o si se debe desactivar el swap.&lt;/p>
&lt;h2 id="ubuntu-2004">Ubuntu 20.04&lt;/h2>
&lt;p>En ubuntu 20.04 podemos ver el estado de la memoria swap con el siguiente comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo swap --show
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># También nos serviría el comando free&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo free -h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para desactivarlas, podemos usar el comando:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo swapoff -a &lt;span style="color:#75715e">#Esto la desactiva, pero solo de forma temporal&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Luego tendríamos que borrar el archivo de intercambio&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo rm /swap.img
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Por último, borramos la línea de swap del fichero de configuración de linux fstab para que no se recree cuando el sistema se reinicie&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo sed -i &lt;span style="color:#e6db74">&amp;#39;/swap/d&amp;#39;&lt;/span> /etc/fstab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: Tmux</title><link>/docs/unix/tmux/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/unix/tmux/</guid><description>
&lt;p>En este entrada vamos a ver cómo utilizar &lt;a href="https://github.com/tmux/tmux/wiki">tmux&lt;/a>. Tmux es un multiplexor de terminales que nos permite crear sesiones de terminal, dividirlas en paneles y ventanas, y acceder a ellas desde cualquier terminal.&lt;/p>
&lt;p>&lt;img src="https://pabpereza.dev/docs/unix/tmux.gif" alt="tmux">&lt;/p>
&lt;h2 id="instalación">Instalación&lt;/h2>
&lt;p>En la mayoría de distribuciones podemos instalar tmux con el gestor de paquetes de la distribución. Por ejemplo, en Ubuntu:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt install tmux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>En macOS podemos instalarlo con &lt;a href="https://brew.sh/">brew&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>brew install tmux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ventanas-o-pestañas">Ventanas o pestañas&lt;/h2>
&lt;p>Dentro de una sesión de tmux, podemos crear pestañas con el comando &lt;code>Ctrl+b c&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para cambiar de pestaña, podemos usar el comando &lt;code>Ctrl+b n&lt;/code> para ir a la siguiente pestaña, o &lt;code>Ctrl+b p&lt;/code> para ir a la anterior:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b n
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Ctrl+b p
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>También podemos ir a una pestaña concreta con el comando &lt;code>Ctrl+b &amp;lt;nombre de la pestaña&amp;gt;&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Podemos renombrar una pestaña con el comando &lt;code>Ctrl+b ,&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b ,
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="paneles-o-splits">Paneles o splits&lt;/h2>
&lt;p>Dentro de una pestaña, podemos dividir la pantalla de forma vertial con el comando &lt;code>Ctrl+b %&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b %
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>O de forma horizontal con el comando &lt;code>Ctrl+b &amp;quot;&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b &lt;span style="color:#e6db74">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para cambiar de panel, podemos usar el comando &lt;code>Ctrl+b&lt;/code> + las flechas de dirección o &lt;code>Ctrl+b&lt;/code> + &lt;code>hjkl&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b &amp;lt;flecha dirección&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Maximizar un panel con el comando &lt;code>Ctrl+b z&lt;/code> y volver a la distribución original con el comando &lt;code>Ctrl+b z&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b z
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Alternar la posición de los paneles con el comando &lt;code>Ctrl+b x&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Podemos listar todos los paneles con el comando &lt;code>Ctrl+b w&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b w
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Por último, podríamos rotar la posición de un panel con las teclas &lt;code>Ctrl+b {&lt;/code> y &lt;code>Ctrl+b }&lt;/code>. Esto alternaría la posición del panel actual con el siguiente:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Ctrl+b &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Ctrl+b &lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="sesiones">Sesiones&lt;/h2>
&lt;p>Para crear una nueva sesión de tmux, ejecutamos el comando &lt;code>tmux&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>tmux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Si queremos crear una sesión con un nombre, podemos usar el parámetro &lt;code>-s&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>tmux new -s my_session
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para listar las sesiones que tenemos abiertas, podemos usar el comando &lt;code>tmux ls&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>tmux ls
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para reanudar una sesión, podemos usar el comando &lt;code>tmux attach&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>tmux attach -t my_session
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Para reanudar la última sesión, podemos usar el comando &lt;code>tmux attach&lt;/code> sin parámetros:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>tmux attach
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Dentro de una sesión, podemos suspenderla con el comando &lt;code>Ctrl+b d&lt;/code>. Esto nos permite volver a la sesión más tarde con el comando &lt;code>tmux attach&lt;/code>.&lt;/p></description></item></channel></rss>